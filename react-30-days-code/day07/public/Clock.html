<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <title>Clock for Understanding Hooks Call</title>
        <!--Script tags including React-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.1/umd/react.production.min.js" integrity="sha512-YMtLFKDKe5a4zi7rJ0y4wdGErKZe3tx7L+AXDTxjNDzkv7jsaNhvumeU1xQvw6UqVwBVmYlO9NhsSuSVPUN/xQ==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.1/umd/react-dom.production.min.js" integrity="sha512-vN6rbu+vWW4Ck3s6RbLZs+0gRl5PWOZRUqap38gZtsheSqA2zDeI3PCshuxfYx7ytkoFMrmd0gA2sZZeP1RZYQ==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js" integrity="sha512-kp7YHLxuJDJcOzStgd6vtpxr4ZU9kjn77e6dBsivSz+pUuAuMlE2UTdKB7jjsWT84qbS8kdCWHPETnP/ctrFsA==" crossorigin="anonymous"></script>
        <link href = "./clock.css" rel="stylesheet" type = "text/css"/>
    </head>
    <body>
        <div id = "app"></div>
        <script type = "text/babel">
            class Clock extends React.Component{

                constructor(props){
                    super(props);
                    this.state = this.getTime();
                }
                
                componentDidMount(){
                    this.setTimer();
                }

                componentWillUnmount () {
                    if(this.timeout){
                        clearTimeout(this.timeout);
                    }
                }

                getTime = () => {
                    const currentTime = new Date();
                    return{
                        hours: currentTime.getHours(),
                        minutes: currentTime.getMinutes(),
                        seconds: currentTime.getSeconds(),
                        ampm: currentTime.getHours() >=12 ? 'pm':'am'
                    }
                }

                setTimer = () =>{
                    clearTimeout(this.timeout);
                    this.timeout = setTimeout(this.updateTimer, 1000);
                }

                updateTimer = () => {
                    this.setState(this.getTime, this.setTimer);
                }

                render(){
                    const {hours, minutes, seconds, ampm} = this.state;
                    return(
                        
                        <div className = "clock">
                            {hours === 0? 12: hours > 12? hours-12 : hours}:
                            {minutes > 9? minutes :`0${minutes}`}:
                            {seconds > 9? seconds :`0${seconds}`} {ampm}
                        </div>
                    );
                }
            }

            ReactDOM.render(<Clock/>, document.getElementById('app'));
        </script>
    </body>
</html>